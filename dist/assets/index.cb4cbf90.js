import{o as i,c as d,a as c,b as p,d as F,r as f,e as te,f as h,g as u,h as oe,v as se,I as S,i as ne,w as re,j as ae,k as ce,l as I,m as M,u as Q,t as m,n as D,p as le,F as L,q as ie,s as de,x as A,y as ue,z as _e,A as he,B as pe,C as me}from"./vendor.438028d3.js";const ge=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function l(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(e){if(e.ep)return;e.ep=!0;const n=l(e);fetch(e.href,n)}};ge();var V="/assets/spotdl.fecdfd79.svg",v=(o,s)=>{const l=o.__vccOpts||o;for(const[t,e]of s)l[t]=e;return l};const fe={components:{},setup(){return{}}},ve={class:"p-10 footer bg-neutral text-neutral-content"},be=c("div",null,[c("img",{src:V,width:"50",height:"50",viewBox:"0 0 24 24"}),c("p",null,[p("spotdl"),c("br"),p("Open Source Music Downloader")])],-1),we=F('<div><span class="footer-title">Social</span><div class="grid grid-flow-col gap-4"><a href="https://github.com/spotDL/spotdl-v4" target="_blank"><svg width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a><a href="https://discord.gg/xCa23pwJWY" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="fill-current" viewBox="0 0 16 16"><path d="M13.545 2.907a13.227 13.227 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.19 12.19 0 0 0-3.658 0 8.258 8.258 0 0 0-.412-.833.051.051 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019c.308-.42.582-.863.818-1.329a.05.05 0 0 0-.01-.059.051.051 0 0 0-.018-.011 8.875 8.875 0 0 1-1.248-.595.05.05 0 0 1-.02-.066.051.051 0 0 1 .015-.019c.084-.063.168-.129.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.052.052 0 0 1 .053.007c.08.066.164.132.248.195a.051.051 0 0 1-.004.085 8.254 8.254 0 0 1-1.249.594.05.05 0 0 0-.03.03.052.052 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.235 13.235 0 0 0 4.001-2.02.049.049 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034 0 0 0-.02-.019Zm-8.198 7.307c-.789 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612Zm5.316 0c-.788 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612Z"></path></svg></a></div></div>',1),ye=[be,we];function $e(o,s,l,t,e,n){return i(),d("footer",ve,ye)}var ke=v(fe,[["render",$e]]);const b=f(""),j=f("light"),K=f("dark");function z(o=!0,s="",l,t){function e(w){j.value=w,g()}function n(w){K.value=w,g()}function a(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function r(w){b.value=w,g()}function _(){b==="dark"?b.value="light":b==="light"&&(b.value="dark"),g()}function g(){document.documentElement.setAttribute("data-theme",b.value==="dark"?K.value:j.value)}return b.value!=="light"&&b.value!=="dark"&&(o&&r(a()),(s==="light"||s==="dark")&&(b.value=s)),l&&e(l),t&&n(t),g(),{currentTheme:b,setLightAlias:e,setDarkAlias:n,getSystemTheme:a,setTheme:r,switchTheme:_}}const xe={name:"App",components:{Footer:ke},setup(){const o=z();return te(()=>{o.setLightAlias("emerald"),o.setDarkAlias("forest")}),{themeMgr:o}}},De={class:"bg-base-300 absolute w-full top-0"};function Se(o,s,l,t,e,n){const a=h("router-view"),r=h("Footer");return i(),d("div",De,[u(a),u(r)])}var Le=v(xe,[["render",Se]]);const y={PROTOCOL:"http",WS_PROTOCOL:"ws",BACKEND:"localhost",PORT:"8800",BASEURL:""};console.log("using env:",{});console.log("using config: ",y);const C=oe.create({baseURL:`${y.PROTOCOL}://${y.BACKEND}:${y.PORT}${y.BASEURL}`}),N=se();console.log("session ID: ",N);const G=new WebSocket(`${y.WS_PROTOCOL}://${y.BACKEND}:${y.PORT}${y.BASEURL}/api/ws?client_id=${N}`);function Oe(o){return C.get("/api/songs/search",{params:{query:o}})}function Re(o){return C.get("/api/song/url",{params:{url:o}})}function Ee(o){return C.post("/api/download/url",null,{params:{url:o,client_id:N}})}function Ae(o){return C.defaults.baseURL+"/api/download/file?file="+o+"&client_id="+N}function Ce(o){return G.onmessage=o}function Ne(o){return G.onerror=o}var O={search:Oe,open:Re,download:Ee,downloadFileURL:Ae,ws_onmessage:Ce,ws_onerror:Ne};const Z=f(""),q=f(),R=f(!1),T=f(!1),B=f("");function W(){function o(e){return s(e)||l(e)}function s(e){return e!==""}function l(e){return!!e.includes("://open.spotify.com/track/")}function t(e){console.log("Searching for:",e),q.value=[],R.value=!0,Z.value=e,T.value=!1,B.value="",O.search(e).then(n=>{console.log("Received Data:",n.data),n.status===200?(q.value=n.data,R.value=!1):(console.log("Error:",n),R.value=!1,T.value=!0,B.value=n.toString())}).catch(n=>{console.log("Other Error:",n.message),R.value=!1,T.value=!0,B.value=n.message})}return{searchTerm:Z,isSearching:R,results:q,error:T,errorValue:B,searchFor:t,isValid:o,isValidSearch:s,isValidURL:l}}const k={QUEUED:"In Queue",DOWNLOADING:"Downloading...",DOWNLOADED:"Done",ERROR:"Error"},x=f([]);class Te{constructor(s){this.song=s,this.web_status=k.QUEUED,this.progress=0,this.message=null,this.web_download_url=null}setDownloading(){this.web_status=k.DOWNLOADING}setDownloaded(){this.web_status=k.DOWNLOADED}setError(){this.web_status=k.ERROR}setWebURL(s){this.web_download_url=s}isQueued(){return this.song.song_id!==void 0}isDownloading(){return this.web_status===k.DOWNLOADING}isDownloaded(){return this.web_status===k.DOWNLOADED}isErrored(){return this.web_status===k.ERROR}wsUpdate(s){this.progress=s.progress,this.message=s.message}}function U(){function o(e){return x.value.findIndex(n=>n.song.song_id===e.song_id)}function s(e){let n=new Te(e);x.value.push(n)}function l(e){console.log("removing",e,e.song_id),x.value=x.value.filter(n=>n.song.song_id!==e.song_id),console.log(x.value)}function t(e){return x.value[o(e)]}return{appendSong:s,removeSong:l,getBySong:t,downloadQueue:x}}const $=U();O.ws_onmessage(o=>{let s=JSON.parse(o.data);$.getBySong(s.song).wsUpdate(s)});function E(){function o(e){O.open(e).then(n=>{if(console.log("Received Response:",n),n.status===200){let a=n.data;console.log("Opened Song:",a),l(a)}else console.log("Error:",n)}).catch(n=>{console.log("Other Error:",n.message)})}function s(e){console.log("Downloading",e),$.getBySong(e).setDownloading(),O.download(e.url).then(n=>{if(console.log("Received Response:",n),n.status===200){let a=n.data;console.log("Download Complete:",a),$.getBySong(e).setWebURL(O.downloadFileURL(a)),$.getBySong(e).setDownloaded()}else console.log("Error:",n),$.getBySong(e).setError()}).catch(n=>{console.log("Other Error:",n.message),$.getBySong(e).setError()})}function l(e,n=!0){$.appendSong(e),n&&s(e)}function t(e){console.log("removing"),$.removeSong(e)}return{fromURL:o,download:s,queue:l,remove:t}}const Be={components:{Icon:S},setup(){const o=W(),s=E(),l=["All Eyes On Me - Bo Burnham","https://open.spotify.com/track/4vfN00PlILRXy5dcXHQE9M?si=e4d9e7c044dd4a8f","Lil Wayne","Drive - Miley Cyrus","Sofia - TMG","Lightning Crashes - Live"],t=f(l[0]),e=setInterval(()=>{l.push(l.shift()),t.value=l[0]},6e3);ne(()=>{clearInterval(e)});function n(r){if(o.isValidURL(r))s.fromURL(r),a({name:"Download"});else if(o.isValidSearch(r)){let _={name:"Search",params:{query:r}};o.isValidSearch(r)&&a(_)}}function a(r){P.push(r)}return{lookUp:n,searchTerm:o.searchTerm,isValidURL:o.isValidURL,placeHolder:t}}},Ue={class:"flex flex-row items-center space-x-4 w-full"},Ie=["placeholder"],Me=p(" \u200B ");function Ve(o,s,l,t,e,n){const a=h("Icon");return i(),d("div",Ue,[re(c("input",{type:"text",placeholder:t.placeHolder,class:"input input-bordered w-full text-base-content","onUpdate:modelValue":s[0]||(s[0]=r=>t.searchTerm=r),onKeyup:s[1]||(s[1]=ce(r=>t.lookUp(t.searchTerm),["enter"]))},null,40,Ie),[[ae,t.searchTerm]]),c("button",{class:"btn btn-square btn-primary",onClick:s[2]||(s[2]=r=>t.lookUp(t.searchTerm))},[Me,t.isValidURL(t.searchTerm)?(i(),I(a,{key:0,icon:"clarity:download-line",class:"h-6 w-6"})):(i(),I(a,{key:1,icon:"clarity:search-line",class:"h-6 w-6"}))])])}var J=v(Be,[["render",Ve]]);const qe={components:{Icon:S,SearchInput:J},setup(){return{themeMgr:z()}}},We={class:"hero min-h-screen"},Pe={key:0,class:"flex justify-end absolute top-0 right-0"},He=["checked"],Fe={class:"block text-center justify-center hero-content"},Qe=F('<div class="bg-cover bg-no-repeat bg-center" data-v-2acc2008><img src="'+V+'" class="mb-5 w-32 center" data-v-2acc2008></div><div class="max-w-lg" data-v-2acc2008><h1 class="mb-5 text-5xl font-bold text-base-content" data-v-2acc2008>spotdl</h1><p class="mb-5 text-base-content" data-v-2acc2008> Download any song and never have to worry about metadata. </p></div>',2);function je(o,s,l,t,e,n){const a=h("SearchInput");return i(),d("div",We,[(i(),d("div",Pe,[c("input",{type:"checkbox",class:"toggle m-5",onChange:s[0]||(s[0]=r=>t.themeMgr.setTheme(r.target.checked?"light":"dark")),checked:t.themeMgr.currentTheme.value==="dark"?!1:"checked"},null,40,He)])),c("div",Fe,[Qe,u(a)])])}var Ke=v(qe,[["render",je],["__scopeId","data-v-2acc2008"]]);const ze={components:{Hero:Ke},setup(){return M(()=>{window.scroll(0,0)}),{}}};function Ge(o,s,l,t,e,n){const a=h("Hero");return i(),I(a)}var Ze=v(ze,[["render",Ge]]);const Je={components:{Icon:S,SearchInput:J},setup(){const o=U(),s=E(),l=Q();function t(e){P.push(e)}return{goto:t,route:l,pt:o,dm:s}}},X=o=>(ie("data-v-3fcc90be"),o=o(),de(),o),Xe={class:"navbar m-2 shadow-lg bg-neutral text-neutral-content rounded-box",style:{width:"auto !important"}},Ye=X(()=>c("div",{class:"bg-cover bg-no-repeat bg-center"},[c("img",{src:V,class:"py-2 pr-2 w-10 center"})],-1)),et=X(()=>c("button",{class:"text-lg font-bold"},"spotdl",-1)),tt=[Ye,et],ot={class:"hidden sm:flex px-2 mx-2 navbar-center w-96 space-x-4"},st={class:"navbar-end"},nt={class:"indicator"},rt={key:0,class:"indicator-item indicator-top indicator-end badge badge-secondary",style:{top:"-5px",right:"-5px"}},at=p(" \u200B "),ct={class:"sm:hidden px-2 mx-2"};function lt(o,s,l,t,e,n){const a=h("SearchInput"),r=h("Icon");return i(),d(L,null,[c("div",Xe,[c("button",{class:"px-2 mx-2 navbar-start",onClick:s[0]||(s[0]=_=>t.goto({name:"Home"}))},tt),c("div",ot,[u(a,{class:"w-full"})]),c("div",st,[c("div",nt,[t.pt.downloadQueue.value.length>0?(i(),d("div",rt,m(t.pt.downloadQueue.value.length),1)):D("",!0),c("a",{class:le(["btn btn-square",t.route.name==="Download"?"btn-primary":"btn-ghost"]),onClick:s[1]||(s[1]=_=>t.goto({name:"Download"}))},[at,u(r,{icon:"clarity:download-cloud-line",class:"h-6 w-6"})],2)])])]),c("div",ct,[u(a,{class:"w-full"})])],64)}var Y=v(Je,[["render",lt],["__scopeId","data-v-3fcc90be"]]);const it={components:{Icon:S},props:["data","error"],emits:["download"],setup(o,s){const l=W(),t=U(),e=E();return{data:o.data,error:o.error,errorValue:l.errorValue,loading:l.isSearching,download:n=>s.emit("download",n),dm:e,pt:t}}},dt={class:"min-h-screen m-2"},ut={key:0,class:"hero min-h-screen"},_t={key:0,class:"btn btn-sm btn-ghost loading"},ht={key:1,class:"alert alert-error"},pt={class:"flex-1"},mt=c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 mx-2 stroke-current"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})],-1),gt={class:"aspect-square md:max-h-fit"},ft=["src"],vt={class:"card-body"},bt={class:"card-title"},wt={key:0,class:"badge mx-0.5 badge-error"},yt={key:0},$t=c("br",null,null,-1),kt=c("p",null,[c("br")],-1),xt={class:"card-actions absolute bottom-0 right-0 m-2"},Dt=["href"],St=p(" \u200B "),Lt={key:0,class:"btn btn-primary btn-square"},Ot=p(" \u200B "),Rt=["onClick"],Et=p(" \u200B ");function At(o,s,l,t,e,n){const a=h("Icon");return i(),d("div",dt,[t.loading||t.error?(i(),d("div",ut,[t.loading?(i(),d("button",_t," LOADING ")):D("",!0),t.error?(i(),d("div",ht,[c("div",pt,[mt,c("label",null,"Error: "+m(t.errorValue),1)])])):D("",!0)])):(i(!0),d(L,{key:1},A(t.data,(r,_)=>{var g;return i(),d("div",{key:_,class:"card md:card-side card-bordered my-2 shadow-lg card-compact bg-base-100"},[c("figure",gt,[c("img",{src:r.cover_url,class:"object-contain aspect-square md:max-h-44"},null,8,ft)]),c("div",vt,[c("h2",bt,[p(m(r.name)+" - "+m(r.artist)+" ",1),r.explicit?(i(),d("div",wt," Explicit ")):D("",!0)]),c("h3",null,[(i(!0),d(L,null,A(r.artists,(w,H)=>(i(),d("a",{key:H},[H!==0?(i(),d("a",yt," \u2022 ")):D("",!0),p(" "+m(w),1)]))),128))]),c("h3",null,m(r.album_name),1),$t,kt,c("div",xt,[c("a",{class:"btn btn-ghost btn-square",href:r.url,target:"_blank"},[St,u(a,{icon:"clarity:link-line",class:"h-6 w-6"})],8,Dt),((g=t.pt.getBySong(r))==null?void 0:g.isQueued())?(i(),d("button",Lt,[Ot,u(a,{icon:"clarity:check-line",class:"h-6 w-6"})])):(i(),d("button",{key:1,class:"btn btn-primary btn-square",onClick:w=>t.download(r)},[Et,u(a,{icon:"clarity:download-line",class:"h-6 w-6"})],8,Rt))])])])}),128))])}var Ct=v(it,[["render",At]]);const Nt={components:{Navbar:Y,SearchList:Ct},setup(){M(()=>{window.scroll(0,0)});const o=Q(),s=W(),l=E();return ue(()=>o.params.query,()=>{o.params.query&&s.searchFor(o.params.query)},{deep:!0}),s.searchFor(o.params.query),{sm:s,dm:l}}};function Tt(o,s,l,t,e,n){const a=h("Navbar"),r=h("SearchList");return i(),d("div",null,[u(a),u(r,{data:t.sm.results,error:t.sm.error,onDownload:s[0]||(s[0]=_=>t.dm.queue(_))},null,8,["data","error"])])}var Bt=v(Nt,[["render",Tt]]);const Ut={components:{Icon:S},props:{data:Object},setup(o,s){const l=U(),t=E();function e(n){const a=document.createElement("a");a.href=n,a.download=n.split("/").pop(),document.body.appendChild(a),a.click(),document.body.removeChild(a)}return{dm:t,pt:l,download:e}}},It={class:"min-h-screen m-2"},Mt={class:"carousel carousel-end bg-base-200 rounded-box shadow-lg"},Vt=["src"],qt={class:"card card-bordered my-2 shadow-lg card-compact bg-base-100"},Wt={class:"card-title"},Pt={class:"stat-figure text-primary flex space-x-2 items-center"},Ht={key:0,class:"badge badge-error gap-2"},Ft={class:"badge"},Qt=["onClick"],jt=p(" \u200B "),Kt=["onClick"],zt=p(" \u200B "),Gt={key:2,class:"btn btn-square btn-ghost loading"};function Zt(o,s,l,t,e,n){const a=h("Icon");return i(),d("div",It,[c("div",Mt,[(i(!0),d(L,null,A(t.pt.downloadQueue.value,(r,_)=>(i(),d("div",{key:_,class:"carousel-item h-48"},[c("img",{src:r.song.cover_url},null,8,Vt)]))),128))]),c("div",qt,[(i(!0),d(L,null,A(t.pt.downloadQueue.value,(r,_)=>(i(),d("div",{key:_,class:"card-body grid grid-rows-1"},[c("h2",Wt,m(r.song.name)+" - "+m(r.song.artist),1),c("p",null,m(r.song.album_name),1),c("div",Pt,[r.isErrored()?(i(),d("div",Ht," error ")):D("",!0),c("span",Ft,m(r.message||r.web_status),1),c("button",{class:"btn btn-error btn-outline btn-square",onClick:g=>t.dm.remove(r.song)},[jt,u(a,{icon:"clarity:trash-line",class:"h-6 w-6"})],8,Qt),r.isDownloaded()?(i(),d("a",{key:1,class:"btn btn-square btn-ghost",href:"javascript:;",onClick:g=>t.download(r.web_download_url),download:""},[zt,u(a,{icon:"clarity:download-line",class:"h-6 w-6"})],8,Kt)):r.progress===0?(i(),d("button",Gt," \u200B ")):(i(),d("div",{key:3,class:"radial-progress bg-primary text-primary-content border-4 border-primary",style:_e(`--value: ${r.progress*100}; --size: 2.5rem`)},m(Math.round(r.progress*100))+"% ",5))])]))),128))])])}var Jt=v(Ut,[["render",Zt]]);const Xt={components:{Navbar:Y,DownloadList:Jt},setup(){return M(()=>{window.scroll(0,0)}),{}}};function Yt(o,s,l,t,e,n){const a=h("Navbar"),r=h("DownloadList");return i(),d("div",null,[u(a),u(r)])}var eo=v(Xt,[["render",Yt]]);const to=[{path:"/",name:"Home",component:Ze},{path:"/search/:query",name:"Search",component:Bt},{path:"/download",name:"Download",component:eo}],P=he({history:pe(),routes:to});const ee=me(Le);ee.use(P);ee.mount("#app");
